http://testninja.info{
    redir https://testninja.info{uri}
}

https://testninja.info{
    reverse_proxy fastapi_app:8000
}

http://app.testninja.info{
    redir https://app.testninja.info{uri}
}

https://app.testninja.info{
    root * /var/www/website
    file_server

    encode gzip

    log{
        output file /var/log/caddy/access.log
        format json
    }

    handle_errors{
        @404{
            expression {http.error.status_code} == 404
        }
        respond @404 "Page Not Found" 404
    }
}